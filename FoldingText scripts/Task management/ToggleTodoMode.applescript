-- Copyright (C) 2012 Robin Trew---- Permission is hereby granted, free of charge, -- to any person obtaining a copy of this software -- and associated documentation files (the "Software"), -- to deal in the Software without restriction, -- including without limitation the rights to use, copy, -- modify, merge, publish, distribute, sublicense, -- and/or sell copies of the Software, and to permit persons -- to whom the Software is furnished to do so, -- subject to the following conditions:-- *******-- The above copyright notice and this permission notice -- shall be included in ALL copies -- or substantial portions of the Software.-- *******-- THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, -- EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES -- OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. -- IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, -- DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, -- TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE -- OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.property pTitle : "Toggle .todo mode on or off in selected line(s)"property pVer : "0.01"property pAuthor : "Robin Trew"-- toggle a mode ON or OFF in selected node(s)property pstrMode : "todo" -- edit this line to adapt for use with other modeson run	ToggleMode(pstrMode)end runon ToggleMode(strModeName)	tell application "FoldingText"		set lstDocs to documents		if lstDocs ≠ {} then			tell item 1 of lstDocs				-- GET NAME OF ANY CURRENT MODE IN *FIRST* SELECTED LINE				set strMode to ""				set recSeln to read selection				try					set strMode to mode of (read nodes at ids [(first item of (nodeIDs of recSeln))])				end try								-- TOGGLE BETWEEN MODE NAME AND EMPTY STRING				if strMode ≠ strModeName then					set strMode to strModeName				else					set strMode to ""				end if								-- UPDATE MODE OF *ALL* SELECTED LINES				set strPath to (nodePath of recSeln) & " except //@type=empty"				update nodes at path strPath with changes {mode:strMode}			end tell		end if	end tellend ToggleMode