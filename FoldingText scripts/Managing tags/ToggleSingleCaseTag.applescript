property pTitle : "Toggle  @tag in the 1st selected line - removing it from elsewhere"property pVer : "0.01"property pstrTag : "localroot" -- NAME OF THE TAG (NO LEADING @, NO ())property pstrAll : "/*///*"on run	tell application "FoldingText"		set lstDocs to documents		if lstDocs â‰  {} then			set oDoc to item 1 of lstDocs			tell oDoc				-- GET THE PATH OF THE SELECTION				set recSeln to read selection				if recSeln is missing value then return				set strSelnPath to (nodePath of recSeln)								-- DOES THE FIRST SELECTED NODE HAVE THIS TAG ?				set lstNodes to read nodes at path strSelnPath				set lngNodes to length of lstNodes				if lngNodes < 1 then return				set oNode to item 1 of lstNodes				set recTags to tags of oNode								-- WE HAVE TO USE A CLIPBOARD HACK TO READ 				-- AN UNKNOWN KEY AT RUN-TIME				set the clipboard to recTags				set blnTagFound to ((the clipboard as list) contains pstrTag)								-- REMOVE ANY CURRENT INSTANCES				set recChanges to {removeTags:{pstrTag}}				update nodes at path pstrAll with changes recChanges								-- IF THE FIRST SELECTED LINE DID NOT HAVE THE TAG, THEN ADD IT				if not blnTagFound then					set recChanges to run script "{addTags:{" & pstrTag & ":\"\"}}"					update nodes at path "//@id=" & |id| of oNode with changes recChanges				end if			end tell		end if	end tellend run